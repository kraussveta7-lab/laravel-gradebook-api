{
    "openapi": "3.0.0",
    "info": {
        "title": "Система оценок (Gradebook API)",
        "description": "API для управления студентами, предметами и их оценками. Использованы Laravel Resources и hasManyThrough.",
        "contact": {
            "email": "artemtaiti@gmail.com"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://127.0.0.1:8000/api",
            "description": "Laravel API Server"
        }
    ],
    "paths": {
        "/students/{student}/grades": {
            "get": {
                "tags": [
                    "Оценки"
                ],
                "summary": "Получить все оценки студента",
                "description": "Возвращает отсортированный список оценок по ID студента, включая предмет (subject).",
                "operationId": "0a7de7d3170cca4e49baedbd5ba5747c",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Успешный ответ",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/GradeResource"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Студент не найден"
                    }
                }
            },
            "post": {
                "tags": [
                    "Оценки"
                ],
                "summary": "Создать новую оценку для студента",
                "operationId": "499dd58a60faa1a91b04cf77fc06b3db",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "subject_id",
                                    "score",
                                    "exam_date"
                                ],
                                "properties": {
                                    "subject_id": {
                                        "type": "integer",
                                        "example": 3
                                    },
                                    "score": {
                                        "type": "integer",
                                        "example": 5
                                    },
                                    "exam_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-11-20"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Оценка успешно создана",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/GradeResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Студент не найден"
                    }
                }
            }
        },
        "/students/{student}/grades/{grade}": {
            "put": {
                "tags": [
                    "Оценки"
                ],
                "summary": "Обновить оценку",
                "operationId": "30e2173d741ab8ba09a3afa089eaaa75",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента (для проверки принадлежности)",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "grade",
                        "in": "path",
                        "description": "ID оценки",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "subject_id",
                                    "score",
                                    "exam_date"
                                ],
                                "properties": {
                                    "subject_id": {
                                        "type": "integer",
                                        "example": 3
                                    },
                                    "score": {
                                        "type": "integer",
                                        "example": 4
                                    },
                                    "exam_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-11-20"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Оценка успешно обновлена",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/GradeResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Оценка не принадлежит указанному студенту"
                    },
                    "404": {
                        "description": "Студент или Оценка не найдены"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Оценки"
                ],
                "summary": "Удалить оценку",
                "operationId": "402813e57ab6930a1f8c6aa3aac55d11",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента (для проверки принадлежности)",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    },
                    {
                        "name": "grade",
                        "in": "path",
                        "description": "ID оценки",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Оценка успешно удалена"
                    },
                    "403": {
                        "description": "Оценка не принадлежит указанному студенту"
                    },
                    "404": {
                        "description": "Студент или Оценка не найдены"
                    }
                }
            }
        },
        "/students": {
            "get": {
                "tags": [
                    "Студенты"
                ],
                "summary": "Получить список всех студентов",
                "operationId": "602b44d362d13bdd9b9131f32a937ae6",
                "responses": {
                    "200": {
                        "description": "Успешный ответ. Возвращает коллекцию студентов.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/StudentResource"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Студенты"
                ],
                "summary": "Создать нового студента",
                "operationId": "07c462c73c16ecd99c5f5b2e67339e23",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "first_name",
                                    "last_name",
                                    "student_id_number"
                                ],
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "example": "Сергей"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "example": "Петров"
                                    },
                                    "student_id_number": {
                                        "type": "string",
                                        "example": "S1002"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Студент успешно создан",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/StudentResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/students/{student}": {
            "get": {
                "tags": [
                    "Студенты"
                ],
                "summary": "Получить данные студента по ID",
                "description": "Включает в себя Eager Loading связей grades и subjects.",
                "operationId": "5b0d7aa428bdb9904461f87fb75c9570",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Успешный ответ",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/StudentResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Студент не найден"
                    }
                }
            },
            "put": {
                "tags": [
                    "Студенты"
                ],
                "summary": "Обновить данные студента",
                "operationId": "dc5a12f258e57ade4154d0b6e99b212d",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "first_name",
                                    "last_name",
                                    "student_id_number"
                                ],
                                "properties": {
                                    "first_name": {
                                        "type": "string",
                                        "example": "Сергей (Обновлено)"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "example": "Петров"
                                    },
                                    "student_id_number": {
                                        "type": "string",
                                        "example": "S1002"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Успешное обновление",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/StudentResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Студент не найден"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Студенты"
                ],
                "summary": "Удалить студента",
                "operationId": "24acd7e6964cb72096ada31630c5051e",
                "parameters": [
                    {
                        "name": "student",
                        "in": "path",
                        "description": "ID студента",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Студент успешно удален (Нет содержимого)"
                    },
                    "404": {
                        "description": "Студент не найден"
                    }
                }
            }
        },
        "/subjects": {
            "get": {
                "tags": [
                    "Предметы"
                ],
                "summary": "Получить список всех предметов",
                "operationId": "2a7ea80416f2d2d5be939b5287b03bc0",
                "responses": {
                    "200": {
                        "description": "Успешный ответ. Возвращает коллекцию предметов с их связями.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "type": "array",
                                            "items": {
                                                "$ref": "#/components/schemas/SubjectResource"
                                            }
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            },
            "post": {
                "tags": [
                    "Предметы"
                ],
                "summary": "Создать новый предмет",
                "operationId": "1f14c36996b396b8c8e42db001a0e017",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "title",
                                    "lecturer_name"
                                ],
                                "properties": {
                                    "title": {
                                        "type": "string",
                                        "example": "История"
                                    },
                                    "lecturer_name": {
                                        "type": "string",
                                        "example": "Петров П.П."
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Предмет успешно создан",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/SubjectResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/subjects/{subject}": {
            "get": {
                "tags": [
                    "Предметы"
                ],
                "summary": "Получить предмет по ID",
                "description": "Включает в себя Eager Loading связей grades и students.",
                "operationId": "08787fe368cbd43448d0c4e1c5c956d5",
                "parameters": [
                    {
                        "name": "subject",
                        "in": "path",
                        "description": "ID предмета",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Успешный ответ",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/SubjectResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Предмет не найден"
                    }
                }
            },
            "put": {
                "tags": [
                    "Предметы"
                ],
                "summary": "Обновить данные предмета",
                "operationId": "ab57b575049f7e7b92e6ccc7ac6fb12b",
                "parameters": [
                    {
                        "name": "subject",
                        "in": "path",
                        "description": "ID предмета",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "title",
                                    "lecturer_name"
                                ],
                                "properties": {
                                    "title": {
                                        "type": "string",
                                        "example": "История (Обновлено)"
                                    },
                                    "lecturer_name": {
                                        "type": "string",
                                        "example": "Петров П.П."
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Успешное обновление",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "data": {
                                            "$ref": "#/components/schemas/SubjectResource"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Предмет не найден"
                    }
                }
            },
            "delete": {
                "tags": [
                    "Предметы"
                ],
                "summary": "Удалить предмет",
                "operationId": "c6dece96323c0586fd57b7b721f125fa",
                "parameters": [
                    {
                        "name": "subject",
                        "in": "path",
                        "description": "ID предмета",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Предмет успешно удален (Нет содержимого)"
                    },
                    "404": {
                        "description": "Предмет не найден"
                    }
                }
            }
        }
    },
    "components": {
        "schemas": {
            "GradeResource": {
                "title": "Grade Resource (Output)",
                "description": "Оценка, возвращаемая API, включая связанный предмет",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 5
                    },
                    "student_id": {
                        "type": "integer",
                        "example": 1
                    },
                    "score": {
                        "type": "integer",
                        "example": 5
                    },
                    "exam_date": {
                        "type": "string",
                        "format": "date",
                        "example": "2025-11-20"
                    },
                    "subject": {
                        "description": "Связанный предмет",
                        "properties": {
                            "id": {
                                "type": "integer",
                                "example": 3
                            },
                            "title": {
                                "type": "string",
                                "example": "Высшая математика"
                            },
                            "lecturer_name": {
                                "type": "string",
                                "example": "Петров"
                            }
                        },
                        "type": "object"
                    }
                },
                "type": "object"
            },
            "StudentResource": {
                "title": "Student Resource (Output)",
                "description": "Студент, возвращаемый API, включая оценки и предметы.",
                "properties": {
                    "id": {
                        "description": "ID студента",
                        "type": "integer",
                        "example": 1
                    },
                    "first_name": {
                        "description": "Имя",
                        "type": "string",
                        "example": "Иван"
                    },
                    "last_name": {
                        "description": "Фамилия",
                        "type": "string",
                        "example": "Иванов"
                    },
                    "student_id_number": {
                        "description": "Номер зачетной книжки / ID",
                        "type": "string",
                        "example": "S1001"
                    },
                    "grades": {
                        "description": "Список оценок студента",
                        "type": "array",
                        "items": {
                            "$ref": "#/components/schemas/GradeResource"
                        }
                    },
                    "subjects": {
                        "description": "Список уникальных предметов, по которым есть оценки (из hasManyThrough)",
                        "type": "array",
                        "items": {
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "example": 3
                                },
                                "title": {
                                    "type": "string",
                                    "example": "Высшая математика"
                                }
                            },
                            "type": "object"
                        }
                    }
                },
                "type": "object"
            },
            "SubjectResource": {
                "title": "Subject Resource (Output)",
                "description": "Предмет, возвращаемый API, включая связанные оценки и студентов.",
                "properties": {
                    "id": {
                        "type": "integer",
                        "example": 3
                    },
                    "title": {
                        "description": "Название предмета",
                        "type": "string",
                        "example": "Высшая математика"
                    },
                    "lecturer_name": {
                        "description": "Имя лектора",
                        "type": "string",
                        "example": "Иванов И.И."
                    },
                    "grades": {
                        "description": "Список оценок по этому предмету (включая студента)",
                        "type": "array",
                        "items": {
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "example": 5
                                },
                                "score": {
                                    "type": "integer",
                                    "example": 5
                                },
                                "exam_date": {
                                    "type": "string",
                                    "format": "date",
                                    "example": "2025-11-20"
                                },
                                "student_id": {
                                    "type": "integer",
                                    "example": 1
                                }
                            },
                            "type": "object"
                        }
                    },
                    "students": {
                        "description": "Список студентов, получивших оценки по этому предмету (из hasManyThrough).",
                        "type": "array",
                        "items": {
                            "properties": {
                                "id": {
                                    "type": "integer",
                                    "example": 1
                                },
                                "first_name": {
                                    "type": "string",
                                    "example": "Иван"
                                },
                                "last_name": {
                                    "type": "string",
                                    "example": "Иванов"
                                }
                            },
                            "type": "object"
                        }
                    }
                },
                "type": "object"
            }
        }
    },
    "tags": [
        {
            "name": "Оценки",
            "description": "Оценки"
        },
        {
            "name": "Студенты",
            "description": "Студенты"
        },
        {
            "name": "Предметы",
            "description": "Предметы"
        }
    ]
}